<!doctype html>
<html>
<head>
	<title data-l10n-id="home.serverName">连星</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="shortcut icon" href="/favicon.ico">
    
    <link href="../static/bootstrap-3.2.0-dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="../static/flat-ui-dist/css/flat-ui.min.css" rel="stylesheet">
    
    <link href="../static/css/common-setting.css" rel="stylesheet">
    <link href="../static/css/insidePageSetting.css" rel="stylesheet">
    <link href="../static/css/subfieldLayout.css" rel="stylesheet">
    <link href="../static/css/pads.css" rel="stylesheet">
</head>

<body>
	<div id="header">
    	<div class="container dispace-1">
        	<span id="welcome">欢迎来到连星</span>&nbsp;&nbsp;
            <span id="introduce">实时互动教学网站</span>
            <div class="btn-group detailGroup pull-right userinfo">
            	<a data-toggle="dropdown" href="#"><img src="../pic/user.png"></a>
                <ul role="menu" class="dropdown-menu userdropdown">
                	<li><a href="#"><span class="fui-user"></span> uiop0009</a></li>
                    <li><a href="#"><span class="fui-gear"></span> 账号设置</a></li>
                    <li><a href="#"><span class="fui-exit"></span> 退出</a></li>
                </ul>
            </div>
            <a class="pull-right notice" href="/user/messages" title="通知"><span class="glyphicon glyphicon-bullhorn"></span> <span id="noticeNum">&nbsp;&nbsp;</span></a>
            
        </div>   
    </div>
    <!--主菜单-->
    <div class="drawShadow">
    <div class="container dispace-1">
    	<nav class="navbar navbar-defind" role="navigation">
        	<div class="navbar-header">
            	<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#mainMenu"></button>
                <a class="navbar-brand-defind" href="/user"><span class="glyphicon glyphicon-send" id="send"></span><span id="logotitle">连 星</span></a>
            </div>
            <div class="collapse navbar-collapse" id="mainMenu">
            	<ul class="nav navbar-nav mainOption">
                	<li><a class="grey" href="/user">&nbsp; 我 &nbsp;</a></li>
                    <li><a class="grey" href="/user/contacts">联系人</a></li>
                    <li><a class="grey" href="/user/userGroups">小组</a></li>
                    <li class="active"><a class="grey" href="/user/pads">文档</a></li>
                    <li><a class="grey" href="/user/slides">幻灯片</a></li>
                </ul>
                <form class="navbar-form navbar-right" id="searchform" action="#" role="search">
                	<div class="form-group">
                    	<div class="input-group">
                        	<input class="form-control" id="searchBox" type="search" placeholder="用户/小组">
                            <span class="input-group-btn">
                            	<button type="submit" class="btn" id="searchBtn"><span class="fui-search"></span></button>
                            </span>
                        </div>
                    </div>
                </form>
            </div>
        </nav>
    </div>
    </div>
    
    <div class="container dispace-2">
    	<div class="row">
        	<div class="col-sm-8 col-xs-7">
    			<p class="standard-title">我的文档(<span id="padsNum">0</span>)</p>
            </div>
            <div class="col-sm-4 col-xs-5">
            	<div class="pull-right" id="addnewdoc">
                	<input type="text" placeholder="文档标题" class="form-control inputnameframe" id="inputdoctitle">
                    <button class="btn btn-newdoc" type="button" id="inputnewdoc">新文档</button>
                </div>
            </div>
        </div>
        <div id="contactsArea">
        	
        </div>
        <div class="center" id="pagechange">
        	<a class="fui-arrow-left" id="prebtn"></a>
            <div id="pagebtn"></div>
            <a class="fui-arrow-right" id="nextbtn"></a>
        </div>
        
    </div>
    
    
    
    
    <div class="footer">
    	<a href="#"><span class="glyphicon glyphicon-send"></span> 连星 @ Copyright by www.hepea.net</a>
    </div>
    
    <!--黑背景-->
    <div id="blackBackground" class="hide">
    </div>
    <!--分享文档弹窗-->
    <div id="addsharewindow" class="addwindow">
        <p class="standard-title windowtitle">分享文档</p>
        <div class="contentframe">
        	<div class="row">
        		<div class="col-sm-3 col-xs-5">
            		<span class="boldtitle">文档名：</span>
            	</div>
            	<div class="col-sm-9 col-xs-7">
            		<span id="doctitle"></span>
            	</div>
        	</div>
            <div class="row">
        		<div class="col-sm-3 col-xs-5">
            		<span class="boldtitle">可共享的组：</span>
            	</div>
            	<div class="col-sm-9 col-xs-7" id="groupAim">
            		
            	</div>
            </div>
            <div class="row">
        		<div class="col-sm-3 col-xs-5">
            		<span class="boldtitle">可共享的联系人：</span>
            	</div>
            	<div class="col-sm-9 col-xs-7" id="contactAim">
            		
            	</div>
            </div>
            </div>
        <div id="closeaddshare" class="closebtn">
            <span class="fui-cross"></span>
        </div>
        <button type="button" class="btn btn-primary confirmBtn" id="sharedocbtn">分 &nbsp; 享</button>
    </div>
            
    
    <script type="text/javascript" src="../static/js/promise.js"></script>
	<script type="text/javascript" src="../static/js/ajax.js"></script>
	<script type="text/javascript" src="../static/js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="../static/flat-ui-dist/js/flat-ui.min.js"></script>
    
    <script type="text/javascript">
		$(function(){
			$('.input-group').on('focus', '.form-control', function () {
      				$(this).closest('.input-group, .form-group').addClass('focus');
    			}).on('blur', '.form-control', function () {
      				$(this).closest('.input-group, .form-group').removeClass('focus');
    			});
			
			$('.detailGroup').each(function(index, element) {
                    $(this).hover(function(){
							clearTimeout(window['t'+index]);
							$(this).addClass('open');
						},function(){
							var $this = $(this);
							window['t'+ index]=setTimeout(function(){$this.removeClass('open');},200);
					});
                });
			
			var contactsArea = $('#contactsArea');
			var pagebtn = $('#pagebtn');
			var lastclick = ' ';
			var curclick = ' ';
			var curN = 1; //当前播放的分页
			var newBtnGroup = '<div class="addshare hide"><span class="addsharebtn"><span class="fui-plus"></span>分享</span></div>';
			var blackBack = $('#blackBackground');
			var data = [17,
			{imgurl: '../pic/paddefaultpic01.png',padid:'r6U39tuI947DENou',padname:'项目报告',profile:'1421329220580'},
			{imgurl: '../pic/paddefaultpic02.png',padid:'vbCqAP7IQQxI5OJH',padname:'写作技巧',profile:'1421238105598'},
			{imgurl: '../pic/paddefaultpic03.png',padid:'DqNU14WfcmwokdJ1',padname:'中国历史纪年',profile:'1419492639515'},
			{imgurl: '../pic/xiangqi.png',padid:'e15CVnZYasU546OP',padname:'象棋残谱',profile:'1419489471649'},
			{imgurl: '../pic/piano.png',padid:'l2N1CMfAq6F3QJdK',padname:'钢琴十二级',profile:'1413803302964'},
			{imgurl: '../pic/kite.png',padid:'r6U39tuI947DENou',padname:'风筝怎么做',profile:' 1422703500509'},
			{imgurl: '../pic/paddefaultpic01.png',padid:'r6U39tuI947DENou',padname:'项目报告',profile:'1421329220580'},
			{imgurl: '../pic/paddefaultpic02.png',padid:'r6U39tuI947DENou',padname:'写作技巧',profile:'1421238105598'},
			{imgurl: '../pic/paddefaultpic03.png',padid:'r6U39tuI947DENou',padname:'中国历史纪年',profile:'1419492639515'},
			{imgurl: '../pic/xiangqi.png',padid:'r6U39tuI947DENou',padname:'象棋残谱',profile:'1419489471649'},
			{imgurl: '../pic/piano.png',padid:'r6U39tuI947DENou',padname:'钢琴十二级',profile:'1422703511161'},
			{imgurl: '../pic/kite.png',padid:'r6U39tuI947DENou',padname:'风筝怎么做',profile:'1421238105598'},
			{imgurl: '../pic/paddefaultpic01.png',padid:'r6U39tuI947DENou',padname:'项目报告',profile:'1421329220580'},
			{imgurl: '../pic/paddefaultpic02.png',padid:'r6U39tuI947DENou',padname:'写作技巧',profile:'1421238105598'},
			{imgurl: '../pic/paddefaultpic03.png',padid:'r6U39tuI947DENou',padname:'中国历史纪年',profile:'1419492639515'},
			{imgurl: '../pic/xiangqi.png',padid:'r6U39tuI947DENou',padname:'象棋残谱',profile:' 1422703041509'},
			{imgurl: '../pic/piano.png',padid:'r6U39tuI947DENou',padname:'钢琴十二级',profile:'1300803302964'}
			];
			
			var datalength = data.length;
			$('#padsNum').html(data[0]);
			
			paging();
			
			function resizeWindow(){
				if($(window).width() >= 975){
					contactsArea.html('<div class="cell3-left"><div class="cellContent"></div></div><div class="cell3-middle"><div class="cellContent"></div></div><div class="cell3-right"><div class="cellContent"></div></div>');
				}
				else if($(window).width() >= 570) {
					contactsArea.html('<div class="cell2-left"><div class="cellContent"></div></div><div class="cell2-right"><div class="cellContent"></div></div>');
				}
				else {
					contactsArea.html('<div class="cell1"><div class="cellContent"></div></div>');
				}
				contactsShow();
				blackBack.css('height',$(document.body).height());
			}
			resizeWindow();
			$(window).resize(resizeWindow);
			
			
			function paging(){//分页
				var contactnum = datalength-1;
				var pagenum = Math.ceil(contactnum/24);
				var htmltext = '';
				for(n = 1; n <= pagenum; n++){
					htmltext += '<a id="pagebtn'+n+'"></a>';
					window['pageArray'+n] = [];
					var arr = window['pageArray'+n];
					for(i = 1; i < 25; i++){
						var id = 24*(n-1)+i;
						if(id < datalength){
							arr.push(id);
						}
						else {
							break;
						}
					}
				}
				pagebtn.html(htmltext);
				for(n = 1; n <= pagenum; n++){
					$('#pagebtn'+n).click({id: n},pagebtnclick);
				}
				$('#prebtn').click(function(){
					var btnid = (curN-1)>0 ? (curN-1) : pagenum;
					$('#pagebtn'+btnid).click();
				});
				$('#nextbtn').click(function(){
					var btnid = (curN+1)<=pagenum ? (curN+1) : 1;
					$('#pagebtn'+btnid).click();
				});
				$('#pagebtn1').click();
			}
			
			function pagebtnclick(e){
				lastclick = curclick;
				curclick = this;
				curN = e.data.id;
				if(curclick != lastclick){
					$(lastclick).removeClass('active');
					$(this).addClass('active');
					contactsShow();
				}
			}
			function contactsShow(){ //分页展示刷新
				var arr = window['pageArray'+curN];
				var cellContent = $('.cellContent');
				var cyclength = cellContent.length;
				var cycid = 0;
				var date = new Date().getTime();
				cellContent.each(function(){
					$(this).html('');
				});
				$.each(arr,function(n,value){
					var imgurl = data[value].imgurl;
					var htmltext = $(cellContent[cycid]).html();
					var difftime = diffTime(date,data[value].profile);
					htmltext += '<div padid="'+data[value].padid+'" class="listItem"><img src="'+imgurl+'" class="itempic pull-left"><p class="itemTitle">'+data[value].padname+'</p><p class="profile">最近更新：'+difftime+'</p>'+newBtnGroup+'</div>';
					$(cellContent[cycid]).html(htmltext);
					if(++cycid >= cyclength){
						cycid = 0;
					}
				});
				addhref();
			}
			function addhref(){//附上链接
				$('.listItem').each(function(index, element) {
                    var This = $(this);
					
					This.hover(function(){
						This.children('.addshare').removeClass('hide');
					},function(){
						This.children('.addshare').addClass('hide');
					});
					This.children('.itemTitle').click(function(){
						var target = '/padDetail/'+This.attr('padid');
						window.open(target);
					});
					This.children().children('.addsharebtn').click(function(){
						
						
					});
                });
			}
			function diffTime(date1,date2){
				var diff = date1-date2;
				var years = Math.floor(diff/(365*24*3600*1000));
				if(years > 0) {return years+"年前";}
				else {
					var days = Math.floor(diff/(24*3600*1000));
					if(days > 0){return days+"天前";}
					else {
						var hours = Math.floor(diff/(3600*1000));
						if(hours > 0) {return hours+"小时前";}
						else {
							var minutes = Math.floor(diff/(60*1000));
							if(minutes > 0) {return minutes+"分钟前";}
							else {return "刚刚";}
						}
					}
				}
			}
			
			
			
			var addsharewindow = $('#addsharewindow');
			var addsharebtn = $('.addsharebtn');
			var closeaddshare = $('#closeaddshare');
			var sharedocbtn = $('#sharedocbtn');
			var doctitle = $('#doctitle');
			var groupAim = $('#groupAim');
			var contactAim  = $('#contactAim');
			var inputnewdoc = $('#inputnewdoc');
			var inputdoctitle = $('#inputdoctitle');
			
			
			function newWindowInit(){
				addsharebtn.each(function(index, element) {
					$(this).click(function(){
						blackBack.removeClass('hide');
						var THIS = this;
						replaceWindow(THIS);
						addsharewindow.css({'transform':'scale(1,1)'});
					});
                });
				closeaddshare.click(closewindow);
				blackBack.click(closewindow);
			}
			newWindowInit();
			function closewindow(){
				blackBack.addClass('hide');
				addsharewindow.css({'transform':'scale(0,0)'});
			}
			function replaceWindow(THIS){
				doctitle.html($(THIS).parent().prevAll('.itemTitle').html());
				//此处需补充请求数据方法
				changeContent();
			}
			var sharedata = [{type:'1',name:'太阳当空照',id:'7bVuYIwacOXU4jia'},
			{type:'1',name:'蓝翔技校',id:'7bVuYIwacOXn2jia'},
			{type:'1',name:'贝壳',id:'7bVuY8wa5OXU4jia'},
			{type:'1',name:' 广场舞研究院',id:'7bVuYIoacOX57jia'},
			{type:'1',name:' GGYY',id:'7bVuY8iacOX44jia'},
			{type:'2',name:' 小飞机',id:'uiop0009'},
			{type:'2',name:'离离原上草',id:'uiop0008'},
			{type:'2',name:' 一岁一枯荣',id:'uiop0007'},
			{type:'2',name:' 野火烧不尽',id:'uiop0006'},
			{type:'2',name:' 春风吹又生',id:'uiop0005'},
			{type:'2',name:' 野草',id:'uiop0004'}
			];
			
			function changeContent(){
				var htmltext1 = '';
				var htmltext2 = '';
				$.each(sharedata, function(n,obj){
					if(obj.type == 1){
						htmltext1 += '<label class="checkbox mycheckbox" for="'+obj.id+'"><input type="checkbox" id="'+obj.id+'" data-toggle="checkbox"><span class="checkName">'+obj.name+'</span></label> &nbsp; &nbsp; &nbsp; ';
					}
					else if(obj.type == 2){
						htmltext2 += '<label class="checkbox mycheckbox" for="'+obj.id+'"><input type="checkbox" id="'+obj.id+'" data-toggle="checkbox"><span class="checkName">'+obj.name+'</span></label> &nbsp; &nbsp; ';
					}
				});
				groupAim.html(htmltext1);
				contactAim.html(htmltext2);
				$('[data-toggle="checkbox"]').radiocheck();
			}
			
			
		});
	</script>
</body>
</html>
